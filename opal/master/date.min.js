Opal.modules.date=function(Opal){function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_lt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.$$$,$$=Opal.$$,$klass=Opal.klass,$send2=Opal.send2,$find_super=Opal.find_super,$truthy=Opal.truthy,$alias=Opal.alias,$send=Opal.send;return Opal.add_stubs(["$include","$<=>","$attr_reader","$nonzero?","$d","$zero?","$new","$class","$-@","$+@","$===","$coerce","$==","$>","$+","$allocate","$join","$compact","$map","$to_proc","$downcase","$wrap","$raise","$clone","$jd","$>>","$wday","$year","$month","$day","$-","$to_s","$to_i","$<","$*","$reverse","$step","$abs","$each"]),function($Date_cweek$57,$Date_cwday$56){var $Date_step$48,$Date_upto$51,$Date_downto$52,$Date_cweek$57=$klass($Date_cweek$57,null,"Date"),$nesting=[$Date_cweek$57].concat($Date_cwday$56);function days_in_month(year,month){return[31,year%4==0&&year%100!=0||year%400==0?29:28,31,30,31,30,31,31,30,31,30,31][month]}$Date_cweek$57.$$prototype.date=nil,$Date_cweek$57.$include($$($nesting,"Comparable")),function($base,$Infinity_to_f$11,$Infinity_$lt_eq_gt$9){var $Infinity_coerce$10,$nesting=[$Infinity_to_f$11=$klass($base,$Infinity_to_f$11,"Infinity")].concat($Infinity_$lt_eq_gt$9);$Infinity_to_f$11.$$prototype.d=nil,$Infinity_to_f$11.$include($$($nesting,"Comparable")),Opal.def($Infinity_to_f$11,"$initialize",$Infinity_$lt_eq_gt$9=function(d){return null==d&&(d=1),this.d=d["$<=>"](0)},$Infinity_$lt_eq_gt$9.$$arity=-1),$Infinity_to_f$11.$attr_reader("d"),Opal.def($Infinity_to_f$11,"$zero?",$Infinity_$lt_eq_gt$9=function(){return!1},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$finite?",$Infinity_$lt_eq_gt$9=function(){return!1},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$infinite?",$Infinity_$lt_eq_gt$9=function(){return this.$d()["$nonzero?"]()},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$nan?",$Infinity_$lt_eq_gt$9=function(){return this.$d()["$zero?"]()},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$abs",$Infinity_$lt_eq_gt$9=function(){return this.$class().$new()},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$-@",$Infinity_$lt_eq_gt$9=function(){return this.$class().$new(this.$d()["$-@"]())},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$+@",$Infinity_$lt_eq_gt$9=function(){return this.$class().$new(this.$d()["$+@"]())},$Infinity_$lt_eq_gt$9.$$arity=0),Opal.def($Infinity_to_f$11,"$<=>",$Infinity_$lt_eq_gt$9=function(other){var $a,$case,r,self=this,l=nil;return function(){if($case=other,$$($nesting,"Infinity")["$==="]($case))return self.$d()["$<=>"](other.$d());if($$($nesting,"Numeric")["$==="]($case))return self.$d();try{return $a=other.$coerce(self),$a=Opal.to_ary($a),l=null==$a[0]?nil:$a[0],r=null==$a[1]?nil:$a[1],l["$<=>"](r)}catch($err){if(!Opal.rescue($err,[$$($nesting,"NoMethodError")]))throw $err;try{return nil}finally{Opal.pop_exception()}}}()},$Infinity_$lt_eq_gt$9.$$arity=1),Opal.def($Infinity_to_f$11,"$coerce",$Infinity_coerce$10=function(other){var $zuper_ii,$iter=$Infinity_coerce$10.$$p,self=this,$case=nil,$zuper=nil,$zuper_i=nil;for($iter&&($Infinity_coerce$10.$$p=null),$zuper_i=0,$zuper_ii=arguments.length,$zuper=new Array($zuper_ii);$zuper_i<$zuper_ii;$zuper_i++)$zuper[$zuper_i]=arguments[$zuper_i];return $case=other,$$($nesting,"Numeric")["$==="]($case)?[self.$d()["$-@"](),self.$d()]:$send2(self,$find_super(self,"coerce",$Infinity_coerce$10,!1,!0),"coerce",$zuper,$iter)},$Infinity_coerce$10.$$arity=1),Opal.def($Infinity_to_f$11,"$to_f",$Infinity_to_f$11=function(){var lhs,rhs;return this.d["$=="](0)?0:$truthy((lhs=this.d,rhs=0,"number"==typeof lhs&&"number"==typeof rhs?rhs<lhs:lhs["$>"](rhs)))?$$$($$($nesting,"Float"),"INFINITY"):$$$($$($nesting,"Float"),"INFINITY")["$-@"]()},$Infinity_to_f$11.$$arity=0)}($nesting[0],$$($nesting,"Numeric"),$nesting),Opal.const_set($nesting[0],"JULIAN",$$($nesting,"Infinity").$new()),Opal.const_set($nesting[0],"GREGORIAN",$$($nesting,"Infinity").$new()["$-@"]()),Opal.const_set($nesting[0],"ITALY",2299161),Opal.const_set($nesting[0],"ENGLAND",2361222),Opal.const_set($nesting[0],"MONTHNAMES",$rb_plus([nil],["January","February","March","April","May","June","July","August","September","October","November","December"])),Opal.const_set($nesting[0],"ABBR_MONTHNAMES",["jan","feb","mar","apr","may","jun","jul","aug","sep","oct","nov","dec"]),Opal.const_set($nesting[0],"DAYNAMES",["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"]),Opal.const_set($nesting[0],"ABBR_DAYNAMES",["Sun","Mon","Tue","Wed","Thu","Fri","Sat"]),function($gregorian_leap$ques$15,$today$14){var $nesting=[$gregorian_leap$ques$15].concat($today$14);$alias($gregorian_leap$ques$15,"civil","new"),Opal.def($gregorian_leap$ques$15,"$wrap",$today$14=function(native$){var instance=nil;return(instance=this.$allocate()).date=native$,instance},$today$14.$$arity=1),Opal.def($gregorian_leap$ques$15,"$parse",$today$14=function(string,comp){null==comp&&(comp=!0);var full_month_name_regexp=new Date,current_day=full_month_name_regexp.getDate(),current_month=full_month_name_regexp.getMonth(),current_year=full_month_name_regexp.getFullYear(),current_wday=full_month_name_regexp.getDay(),full_month_name_regexp=$$($nesting,"MONTHNAMES").$compact().$join("|");function match1(match){return match[1]}function match2(match){return match[2]}function match3(match){return match[3]}function match4(match){return match[4]}function fromShortYear(fn){return function(short_year){short_year=fn(short_year);return short_year+=69<=short_year?1900:2e3}}function fromMonthAbbr(fn){return function(abbr){abbr=fn(abbr).toLowerCase();return $$($nesting,"ABBR_MONTHNAMES").indexOf(abbr)+1}}function toInt(fn){return function(value){value=fn(value);return parseInt(value,10)}}function fromFullMonthName(fn){return function(month_name){month_name=fn(month_name);return $send($$($nesting,"MONTHNAMES").$compact(),"map",[],"downcase".$to_proc()).indexOf(month_name.$downcase())+1}}for(var fn,match,rules=[{regexp:/^(\d{2})$/,year:current_year,month:current_month,day:toInt(match1)},{regexp:/^(\d{3})$/,year:current_year,month:0,day:toInt(match1)},{regexp:/^(\d{2})(\d{2})$/,year:current_year,month:toInt(match1),day:toInt(match2)},{regexp:/^(\d{2})(\d{3})$/,year:fromShortYear(toInt(match1)),month:0,day:toInt(match2)},{regexp:/^(\d{2})(\d{2})(\d{2})$/,year:fromShortYear(toInt(match1)),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{4})(\d{3})$/,year:toInt(match1),month:0,day:toInt(match2)},{regexp:/^(\d{4})(\d{2})(\d{2})$/,year:toInt(match1),month:toInt(match2),day:toInt(match3)},{regexp:/^([a-z]{3})[\s\.\/\-](\d{3,4})$/,year:toInt(match2),month:fromMonthAbbr(match1),day:1},{regexp:/^(\d{1,2})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{3,4})$/i,year:toInt(match3),month:fromMonthAbbr(match2),day:toInt(match1)},{regexp:/^([a-z]{3})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{3,4})$/i,year:toInt(match3),month:fromMonthAbbr(match1),day:toInt(match2)},{regexp:/^(\d{3,4})[\s\.\/\-]([a-z]{3})[\s\.\/\-](\d{1,2})$/i,year:toInt(match1),month:fromMonthAbbr(match2),day:toInt(match3)},{regexp:/^(\-?\d{3,4})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,year:toInt(match1),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\d{1,2})$/,year:(fn=toInt(match1),function(value){value=fn(value);return comp?value+2e3:value}),month:toInt(match2),day:toInt(match3)},{regexp:/^(\d{1,2})[\s\.\/\-](\d{1,2})[\s\.\/\-](\-?\d{3,4})$/,year:toInt(match3),month:toInt(match2),day:toInt(match1)},{regexp:new RegExp("^("+$$($nesting,"DAYNAMES").$join("|")+")$","i"),year:current_year,month:current_month,day:function(fn){return function(wday){wday=fn(wday),wday=$send($$($nesting,"DAYNAMES"),"map",[],"downcase".$to_proc()).indexOf(wday.$downcase());return current_day-current_wday+wday}}(match1)},{regexp:new RegExp("^("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-](\\-?\\d{3,4})$","i"),year:toInt(match4),month:fromFullMonthName(match1),day:toInt(match2)},{regexp:new RegExp("^("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)","i"),year:current_year,month:fromFullMonthName(match1),day:toInt(match2)},{regexp:new RegExp("^(\\d{1,2})(th|nd|rd)[\\s\\.\\/\\-]("+full_month_name_regexp+")[\\s\\.\\/\\-](\\-?\\d{3,4})$","i"),year:toInt(match4),month:fromFullMonthName(match3),day:toInt(match1)},{regexp:new RegExp("^(\\-?\\d{3,4})[\\s\\.\\/\\-]("+full_month_name_regexp+")[\\s\\.\\/\\-](\\d{1,2})(th|nd|rd)$","i"),year:toInt(match1),month:fromFullMonthName(match2),day:toInt(match3)}],i=0;i<rules.length;i++)if(match=(result=rules[i]).regexp.exec(string)){var year=result.year;"function"==typeof year&&(year=year(match));var month=result.month;"function"==typeof month&&(month=month(match)-1);var result=result.day;"function"==typeof result&&(result=result(match));result=new Date(year,month,result);return 0<=year&&year<=1970&&result.setFullYear(year),this.$wrap(result)}return this.$raise($$($nesting,"ArgumentError"),"invalid date")},$today$14.$$arity=-2),Opal.def($gregorian_leap$ques$15,"$today",$today$14=function(){return this.$wrap(new Date)},$today$14.$$arity=0),Opal.def($gregorian_leap$ques$15,"$gregorian_leap?",$gregorian_leap$ques$15=function(year){return new Date(year,1,29).getMonth()-1==0},$gregorian_leap$ques$15.$$arity=1)}(Opal.get_singleton_class($Date_cweek$57),$nesting),Opal.def($Date_cweek$57,"$initialize",$Date_cwday$56=function(year,month,day,start){return null==year&&(year=-4712),null==month&&(month=1),null==day&&(day=1),null==start&&(start=$$($nesting,"ITALY")),1582===year&&10===month&&4<day&&day<15&&(day=4),this.date=new Date(year,month-1,day)},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$-",$Date_cwday$56=function(date){if(date.$$is_number){var result=this.$clone();return result.date.setDate(this.date.getDate()-date),result}if(date.date)return Math.round((this.date-date.date)/864e5);this.$raise($$($nesting,"TypeError"))},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$+",$Date_cwday$56=function(date){if(date.$$is_number){var result=this.$clone();return result.date.setDate(this.date.getDate()+date),result}this.$raise($$($nesting,"TypeError"))},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$<",$Date_cwday$56=function(b){var a=this.date,b=b.date;return a.setHours(0,0,0,0),b.setHours(0,0,0,0),a<b},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$<=",$Date_cwday$56=function(b){var a=this.date,b=b.date;return a.setHours(0,0,0,0),b.setHours(0,0,0,0),a<=b},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$>",$Date_cwday$56=function(b){var a=this.date,b=b.date;return a.setHours(0,0,0,0),b.setHours(0,0,0,0),b<a},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$>=",$Date_cwday$56=function(b){var a=this.date,b=b.date;return a.setHours(0,0,0,0),b.setHours(0,0,0,0),b<=a},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$<=>",$Date_cwday$56=function(b){if(b.$$is_number)return this.$jd()["$<=>"](b);if($$($nesting,"Date")["$==="](b)){var a=this.date,b=b.date;return a.setHours(0,0,0,0),b.setHours(0,0,0,0),a<b?-1:b<a?1:0}return nil},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$>>",$Date_cwday$56=function(n){n.$$is_number||this.$raise($$($nesting,"TypeError"));var result=this.$clone(),date=result.date,cur=date.getDate();return date.setDate(1),date.setMonth(date.getMonth()+n),date.setDate(Math.min(cur,days_in_month(date.getFullYear(),date.getMonth()))),result},$Date_cwday$56.$$arity=1),Opal.def($Date_cweek$57,"$<<",$Date_cwday$56=function(n){return n.$$is_number||this.$raise($$($nesting,"TypeError")),this["$>>"](-n)},$Date_cwday$56.$$arity=1),$alias($Date_cweek$57,"eql?","=="),Opal.def($Date_cweek$57,"$clone",$Date_cwday$56=function(){return $$($nesting,"Date").$wrap(new Date(this.date.getTime()))},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$day",$Date_cwday$56=function(){return this.date.getDate()},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$friday?",$Date_cwday$56=function(){return this.$wday()["$=="](5)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$jd",$Date_cwday$56=function(){var mm=this.date.getMonth()+1,dd=this.date.getDate(),yy=this.date.getFullYear(),ggg=yy<=1585?0:1,jd=-1*Math.floor(7*(Math.floor((mm+9)/12)+yy)/4),s=mm-9<0?-1:1,j1=Math.abs(mm-9),j1=Math.floor(yy+s*Math.floor(j1/7));return j1=-1*Math.floor(3*(Math.floor(j1/100)+1)/4),.5+(jd+Math.floor(275*mm/9)+dd+ggg*j1+1721027+2*ggg+367*yy-.5)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$julian?",$Date_cwday$56=function(){return this.date<new Date(1582,9,15,12)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$monday?",$Date_cwday$56=function(){return this.$wday()["$=="](1)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$month",$Date_cwday$56=function(){return this.date.getMonth()+1},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$next",$Date_cwday$56=function(){return $rb_plus(this,1)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$next_day",$Date_cwday$56=function(n){return null==n&&(n=1),$rb_plus(this,n)},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$next_month",$Date_cwday$56=function(n){null==n&&(n=1);var result=this.$clone(),date=result.date,cur=date.getDate();return date.setDate(1),date.setMonth(date.getMonth()+n),date.setDate(Math.min(cur,days_in_month(date.getFullYear(),date.getMonth()))),result},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$next_year",$Date_cwday$56=function(years){return null==years&&(years=1),this.$class().$new($rb_plus(this.$year(),years),this.$month(),this.$day())},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$prev_day",$Date_cwday$56=function(n){return null==n&&(n=1),$rb_minus(this,n)},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$prev_month",$Date_cwday$56=function(n){null==n&&(n=1);var result=this.$clone(),date=result.date,cur=date.getDate();return date.setDate(1),date.setMonth(date.getMonth()-n),date.setDate(Math.min(cur,days_in_month(date.getFullYear(),date.getMonth()))),result},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$prev_year",$Date_cwday$56=function(years){return null==years&&(years=1),this.$class().$new($rb_minus(this.$year(),years),this.$month(),this.$day())},$Date_cwday$56.$$arity=-1),Opal.def($Date_cweek$57,"$saturday?",$Date_cwday$56=function(){return this.$wday()["$=="](6)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$strftime",$Date_cwday$56=function(format){return null==format&&(format=""),""==format?this.$to_s():this.date.$strftime(format)},$Date_cwday$56.$$arity=-1),$alias($Date_cweek$57,"succ","next"),Opal.def($Date_cweek$57,"$sunday?",$Date_cwday$56=function(){return this.$wday()["$=="](0)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$thursday?",$Date_cwday$56=function(){return this.$wday()["$=="](4)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$to_s",$Date_cwday$56=function(){var day=this.date,year=day.getFullYear(),month=day.getMonth()+1,day=day.getDate();return month<10&&(month="0"+month),day<10&&(day="0"+day),year+"-"+month+"-"+day},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$to_time",$Date_cwday$56=function(){return $$($nesting,"Time").$new(this.$year(),this.$month(),this.$day())},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$to_n",$Date_cwday$56=function(){return this.date},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$tuesday?",$Date_cwday$56=function(){return this.$wday()["$=="](2)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$step",$Date_step$48=function(lhs,step){var $$49,$$50,steps,result,rhs=$Date_step$48.$$p,block=rhs||nil,steps_count=nil;return rhs&&($Date_step$48.$$p=null),rhs&&($Date_step$48.$$p=null),null==step&&(step=1),steps_count=$rb_minus(lhs,this).$to_i(),steps=$truthy($rb_lt((rhs=step,"number"==typeof(lhs=steps_count)&&"number"==typeof rhs?lhs*rhs:lhs["$*"](rhs)),0))?[]:$truthy($rb_lt(steps_count,0))?$send(Opal.Range.$new(0,steps_count["$-@"](),!1).$step(step.$abs()),"map",[],"-@".$to_proc()).$reverse():Opal.Range.$new(0,steps_count,!1).$step(step.$abs()),result=$send(steps,"map",[],(($$49=function(i){var self=null==$$49.$$s?this:$$49.$$s;return null==i&&(i=nil),$rb_plus(self,i)}).$$s=this,$$49.$$arity=1,$$49)),block!==nil?($send(result,"each",[],(($$50=function(i){null==$$50.$$s||$$50.$$s;return null==i&&(i=nil),Opal.yield1(block,i)}).$$s=this,$$50.$$arity=1,$$50)),this):result},$Date_step$48.$$arity=-2),Opal.def($Date_cweek$57,"$upto",$Date_upto$51=function(max){var $iter=$Date_upto$51.$$p,block=$iter||nil;return $iter&&($Date_upto$51.$$p=null),$iter&&($Date_upto$51.$$p=null),$send(this,"step",[max,1],block.$to_proc())},$Date_upto$51.$$arity=1),Opal.def($Date_cweek$57,"$downto",$Date_downto$52=function(min){var $iter=$Date_downto$52.$$p,block=$iter||nil;return $iter&&($Date_downto$52.$$p=null),$iter&&($Date_downto$52.$$p=null),$send(this,"step",[min,-1],block.$to_proc())},$Date_downto$52.$$arity=1),Opal.def($Date_cweek$57,"$wday",$Date_cwday$56=function(){return this.date.getDay()},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$wednesday?",$Date_cwday$56=function(){return this.$wday()["$=="](3)},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$year",$Date_cwday$56=function(){return this.date.getFullYear()},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$cwday",$Date_cwday$56=function(){return this.date.getDay()||7},$Date_cwday$56.$$arity=0),Opal.def($Date_cweek$57,"$cweek",$Date_cweek$57=function(){var d=new Date(this.date);return d.setHours(0,0,0),d.setDate(d.getDate()+4-(d.getDay()||7)),Math.ceil(((d-new Date(d.getFullYear(),0,1))/864e5+1)/7)},$Date_cweek$57.$$arity=0)}($nesting[0],$nesting)};
