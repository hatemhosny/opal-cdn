Opal.modules.strscan=function(Opal){Opal.top;var $nesting=[],nil=Opal.nil,$$=(Opal.$$$,Opal.$$),$klass=Opal.klass,$alias=Opal.alias,$truthy=Opal.truthy,$send=Opal.send;return Opal.add_stubs(["$attr_reader","$anchor","$empty?","$===","$to_s","$coerce_to!","$scan_until","$length","$size","$rest","$pos=","$-","$private"]),function($StringScanner_anchor$25,$StringScanner_unscan$24){var $StringScanner_anchor$25=$klass($StringScanner_anchor$25,null,"StringScanner"),$nesting=[$StringScanner_anchor$25].concat($StringScanner_unscan$24);return $StringScanner_anchor$25.$$prototype.pos=$StringScanner_anchor$25.$$prototype.string=$StringScanner_anchor$25.$$prototype.working=$StringScanner_anchor$25.$$prototype.matched=$StringScanner_anchor$25.$$prototype.prev_pos=$StringScanner_anchor$25.$$prototype.match=nil,$StringScanner_anchor$25.$attr_reader("pos"),$StringScanner_anchor$25.$attr_reader("matched"),Opal.def($StringScanner_anchor$25,"$initialize",$StringScanner_unscan$24=function(string){return this.string=string,this.pos=0,this.matched=nil,this.working=string,this.match=[]},$StringScanner_unscan$24.$$arity=1),$StringScanner_anchor$25.$attr_reader("string"),Opal.def($StringScanner_anchor$25,"$beginning_of_line?",$StringScanner_unscan$24=function(){return 0===this.pos||"\n"===this.string.charAt(this.pos-1)},$StringScanner_unscan$24.$$arity=0),$alias($StringScanner_anchor$25,"bol?","beginning_of_line?"),Opal.def($StringScanner_anchor$25,"$scan",$StringScanner_unscan$24=function(result){result=(result=this.$anchor(result)).exec(this.working);return null==result?this.matched=nil:"object"==typeof result?(this.prev_pos=this.pos,this.pos+=result[0].length,this.working=this.working.substring(result[0].length),this.matched=result[0],(this.match=result)[0]):"string"==typeof result?(this.pos+=result.length,this.working=this.working.substring(result.length),result):nil},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$scan_until",$StringScanner_unscan$24=function(pattern){pattern=this.$anchor(pattern);for(var result,pos=this.pos,working=this.working;;){if(result=pattern.exec(working),pos+=1,working=working.substr(1),null!=result)return this.matched=this.string.substr(this.pos,pos-this.pos-1+result[0].length),this.match=result,this.prev_pos=pos-1,this.pos=pos,this.working=working.substr(result[0].length),this.matched;if(0===working.length)return this.match=[],this.matched=nil}},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$[]",$StringScanner_unscan$24=function(idx){if($truthy(this.match["$empty?"]()))return nil;match=idx,$$($nesting,"Symbol")["$==="](match)?idx=idx.$to_s():$$($nesting,"String")["$==="](match)||(idx=$$($nesting,"Opal")["$coerce_to!"](idx,$$($nesting,"Integer"),"to_int"));var match=this.match;return idx<0&&(idx+=match.length),idx<0||idx>=match.length||null==match[idx]?nil:match[idx]},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$check",$StringScanner_unscan$24=function(result){result=(result=this.$anchor(result)).exec(this.working);return this.matched=null==result?nil:result[0]},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$check_until",$StringScanner_unscan$24=function(result){var prev_pos=this.prev_pos,pos=this.pos,result=this.$scan_until(result);return result!==nil&&(this.matched=result.substr(-1),this.working=this.string.substr(pos)),this.prev_pos=prev_pos,this.pos=pos,result},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$peek",$StringScanner_unscan$24=function(length){return this.working.substring(0,length)},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$eos?",$StringScanner_unscan$24=function(){return 0===this.working.length},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$exist?",$StringScanner_unscan$24=function(result){result=result.exec(this.working);return null==result?nil:0==result.index?0:result.index+1},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$skip",$StringScanner_unscan$24=function(match_len){var result=(match_len=this.$anchor(match_len)).exec(this.working);if(null==result)return this.match=[],this.matched=nil;var match_str=result[0],match_len=match_str.length;return this.matched=match_str,this.match=result,this.prev_pos=this.pos,this.pos+=match_len,this.working=this.working.substring(match_len),match_len},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$skip_until",$StringScanner_unscan$24=function(result){result=this.$scan_until(result);return result===nil?nil:(this.matched=result.substr(-1),result.length)},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$get_byte",$StringScanner_unscan$24=function(){var result=nil;return this.pos<this.string.length?(this.prev_pos=this.pos,this.pos+=1,result=this.matched=this.working.substring(0,1),this.working=this.working.substring(1)):this.matched=nil,result},$StringScanner_unscan$24.$$arity=0),$alias($StringScanner_anchor$25,"getch","get_byte"),Opal.def($StringScanner_anchor$25,"$match?",$StringScanner_unscan$24=function(result){result=(result=this.$anchor(result)).exec(this.working);return null==result?nil:(this.prev_pos=this.pos,result[0].length)},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$pos=",$StringScanner_unscan$24=function(pos){return pos<0&&(pos+=this.string.$length()),this.pos=pos,this.working=this.string.slice(pos)},$StringScanner_unscan$24.$$arity=1),Opal.def($StringScanner_anchor$25,"$matched_size",$StringScanner_unscan$24=function(){return this.matched===nil?nil:this.matched.length},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$post_match",$StringScanner_unscan$24=function(){return this.matched===nil?nil:this.string.substr(this.pos)},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$pre_match",$StringScanner_unscan$24=function(){return this.matched===nil?nil:this.string.substr(0,this.prev_pos)},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$reset",$StringScanner_unscan$24=function(){return this.working=this.string,this.matched=nil,this.pos=0},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$rest",$StringScanner_unscan$24=function(){return this.working},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$rest?",$StringScanner_unscan$24=function(){return 0!==this.working.length},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$rest_size",$StringScanner_unscan$24=function(){return this.$rest().$size()},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$terminate",$StringScanner_unscan$24=function(){var rhs,lhs=nil;return this.match=nil,lhs=[this.string.$length()],$send(this,"pos=",Opal.to_a(lhs)),lhs[rhs=1,"number"==typeof(lhs=lhs.length)&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)]},$StringScanner_unscan$24.$$arity=0),Opal.def($StringScanner_anchor$25,"$unscan",$StringScanner_unscan$24=function(){return this.pos=this.prev_pos,this.prev_pos=nil,this.match=nil,this},$StringScanner_unscan$24.$$arity=0),$StringScanner_anchor$25.$private(),Opal.def($StringScanner_anchor$25,"$anchor",$StringScanner_anchor$25=function(pattern){var flags=(flags=pattern.toString().match(/\/([^\/]+)$/))?flags[1]:void 0;return new RegExp("^(?:"+pattern.source+")",flags)},$StringScanner_anchor$25.$$arity=1),nil&&"anchor"}($nesting[0],$nesting)};
