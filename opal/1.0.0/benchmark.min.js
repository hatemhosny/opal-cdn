Opal.modules.benchmark=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_times(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs*rhs:lhs["$*"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.const_get_qualified,$$=Opal.const_get_relative,$module=(Opal.breaker,Opal.slice,Opal.module),$send=Opal.send,$truthy=Opal.truthy,$klass=Opal.klass,$gvars=Opal.gvars;return Opal.add_stubs(["$sync","$sync=","$-","$+","$empty?","$print","$*","$new","$===","$each","$grep","$ljust","$shift","$label","$format","$list","$nil?","$benchmark","$to_proc","$width","$puts","$length","$inject","$measure","$rjust","$map","$start","$tap","$times","$clock_gettime","$utime","$stime","$cutime","$cstime","$module_function","$raise","$to_s","$<","$<<","$attr_reader","$real","$memberwise","$gsub","$dup","$%","$total","$protected","$__send__"]),function($base,$parent_nesting){var $Benchmark_benchmark$1,$Benchmark_bm$3,$Benchmark_bmbm$4,$b,$Benchmark_measure$8,$Benchmark_realtime$9,self=$module($base,"Benchmark"),$nesting=[self].concat($parent_nesting);Opal.const_set($nesting[0],"BENCHMARK_VERSION","2002-04-25"),Opal.def(self,"$benchmark",$Benchmark_benchmark$1=function($a,$b,$c,$d){var $post_args,caption,label_width,format,labels,$e,$$2,$iter=$Benchmark_benchmark$1.$$p,$yield=$iter||nil,self=this,sync=nil,$writer=nil,report=nil,results=nil;return $iter&&($Benchmark_benchmark$1.$$p=null),0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(caption=$post_args[0],$post_args.splice(0,1)),null==caption&&(caption=""),0<$post_args.length&&(label_width=$post_args[0],$post_args.splice(0,1)),null==label_width&&(label_width=nil),0<$post_args.length&&(format=$post_args[0],$post_args.splice(0,1)),null==format&&(format=nil),labels=$post_args,function(){try{return sync=$$($nesting,"STDOUT").$sync(),$writer=[!0],$send($$($nesting,"STDOUT"),"sync=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],label_width=$rb_plus(label_width=$truthy($e=label_width)?$e:0,1),format=$truthy($e=format)?$e:$$($nesting,"FORMAT"),$truthy(caption["$empty?"]())||self.$print($rb_plus($rb_times(" ",label_width),caption)),report=$$($nesting,"Report").$new(label_width,format),results=Opal.yield1($yield,report),$truthy($e=$$($nesting,"Array")["$==="](results))&&$send(results.$grep($$($nesting,"Tms")),"each",[],(($$2=function(t){var $f,$g,self=$$2.$$s||this;return null==t&&(t=nil),self.$print(($truthy($f=$truthy($g=labels.$shift())?$g:t.$label())?$f:"").$ljust(label_width),t.$format(format))}).$$s=self,$$2.$$arity=1,$$2)),report.$list()}finally{$truthy(sync["$nil?"]())||($writer=[sync],$send($$($nesting,"STDOUT"),"sync=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)])}}()},$Benchmark_benchmark$1.$$arity=-1),Opal.def(self,"$bm",$Benchmark_bm$3=function($a,$b){var $post_args,label_width,labels,$iter=$Benchmark_bm$3.$$p,blk=$iter||nil;return $iter&&($Benchmark_bm$3.$$p=null),$iter&&($Benchmark_bm$3.$$p=null),0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(label_width=$post_args[0],$post_args.splice(0,1)),null==label_width&&(label_width=0),labels=$post_args,$send(this,"benchmark",[$$($nesting,"CAPTION"),label_width,$$($nesting,"FORMAT")].concat(Opal.to_a(labels)),blk.$to_proc())},$Benchmark_bm$3.$$arity=-1),Opal.def(self,"$bmbm",$Benchmark_bmbm$4=function(width){var $$5,$$6,$iter=$Benchmark_bmbm$4.$$p,$yield=$iter||nil,self=this,job=nil,sync=nil,$writer=nil,ets=nil;return $iter&&($Benchmark_bmbm$4.$$p=null),null==width&&(width=0),function(){try{return job=$$($nesting,"Job").$new(width),Opal.yield1($yield,job),width=$rb_plus(job.$width(),1),sync=$$($nesting,"STDOUT").$sync(),$writer=[!0],$send($$($nesting,"STDOUT"),"sync=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)],self.$puts("Rehearsal ".$ljust($rb_plus(width,$$($nesting,"CAPTION").$length()),"-")),ets=$send(job.$list(),"inject",[$$($nesting,"Tms").$new()],($$5=function(sum,$mlhs_tmp1){var $a,$b,self=$$5.$$s||this,label=nil,item=nil,res=nil;return null==sum&&(sum=nil),null==$mlhs_tmp1&&($mlhs_tmp1=nil),$b=$mlhs_tmp1,label=null==($a=Opal.to_ary($b))[0]?nil:$a[0],item=null==$a[1]?nil:$a[1],self.$print(label.$ljust(width)),res=$send($$($nesting,"Benchmark"),"measure",[],item.$to_proc()),self.$print(res.$format()),$rb_plus(sum,res)},$$5.$$s=self,$$5.$$arity=2,$$5.$$has_top_level_mlhs_arg=!0,$$5)).$format("total: %tsec"),self.$print((" "+ets+"\n\n").$rjust($rb_plus($rb_plus(width,$$($nesting,"CAPTION").$length()),2),"-")),self.$print($rb_plus($rb_times(" ",width),$$($nesting,"CAPTION"))),$send(job.$list(),"map",[],(($$6=function(label,item){var $$7,self=$$6.$$s||this;return null==label&&(label=nil),null==item&&(item=nil),$$($nesting,"GC").$start(),self.$print(label.$ljust(width)),$send($send($$($nesting,"Benchmark"),"measure",[label],item.$to_proc()),"tap",[],(($$7=function(res){var self=$$7.$$s||this;return null==res&&(res=nil),self.$print(res)}).$$s=self,$$7.$$arity=1,$$7))}).$$s=self,$$6.$$arity=2,$$6))}finally{$truthy(sync["$nil?"]())||($writer=[sync],$send($$($nesting,"STDOUT"),"sync=",Opal.to_a($writer)),$writer[$rb_minus($writer.length,1)])}}()},$Benchmark_bmbm$4.$$arity=-1),$truthy(($b=$$($nesting,"Process","skip_raise"))&&$$$($b,"CLOCK_MONOTONIC","skip_raise")?"constant":nil)?Opal.const_set($nesting[0],"BENCHMARK_CLOCK",$$$($$($nesting,"Process"),"CLOCK_MONOTONIC")):Opal.const_set($nesting[0],"BENCHMARK_CLOCK",$$$($$($nesting,"Process"),"CLOCK_REALTIME")),Opal.def(self,"$measure",$Benchmark_measure$8=function(label){var $a,r0,r1,$iter=$Benchmark_measure$8.$$p,$yield=$iter||nil,t0=nil,t1=nil;return $iter&&($Benchmark_measure$8.$$p=null),null==label&&(label=""),t0=($a=[$$($nesting,"Process").$times(),$$($nesting,"Process").$clock_gettime($$($nesting,"BENCHMARK_CLOCK"))])[0],r0=$a[1],Opal.yieldX($yield,[]),t1=($a=[$$($nesting,"Process").$times(),$$($nesting,"Process").$clock_gettime($$($nesting,"BENCHMARK_CLOCK"))])[0],r1=$a[1],$$$($$($nesting,"Benchmark"),"Tms").$new($rb_minus(t1.$utime(),t0.$utime()),$rb_minus(t1.$stime(),t0.$stime()),$rb_minus(t1.$cutime(),t0.$cutime()),$rb_minus(t1.$cstime(),t0.$cstime()),$rb_minus(r1,r0),label)},$Benchmark_measure$8.$$arity=-1),Opal.def(self,"$realtime",$Benchmark_realtime$9=function(){var r0,$iter=$Benchmark_realtime$9.$$p,$yield=$iter||nil;return $iter&&($Benchmark_realtime$9.$$p=null),r0=$$($nesting,"Process").$clock_gettime($$($nesting,"BENCHMARK_CLOCK")),Opal.yieldX($yield,[]),$rb_minus($$($nesting,"Process").$clock_gettime($$($nesting,"BENCHMARK_CLOCK")),r0)},$Benchmark_realtime$9.$$arity=0),self.$module_function("benchmark","measure","realtime","bm","bmbm"),function($base,$super,$parent_nesting){var $Job_initialize$10,$Job_item$11,self=$klass($base,null,"Job"),$nesting=[self].concat($parent_nesting);self.$$prototype.width=self.$$prototype.list=nil,Opal.def(self,"$initialize",$Job_initialize$10=function(width){return this.width=width,this.list=[]},$Job_initialize$10.$$arity=1),Opal.def(self,"$item",$Job_item$11=function(label){var w,lhs,rhs,$iter=$Job_item$11.$$p,blk=$iter||nil;return $iter&&($Job_item$11.$$p=null),$iter&&($Job_item$11.$$p=null),null==label&&(label=""),blk!==nil||this.$raise($$($nesting,"ArgumentError"),"no block"),w=(label=label.$to_s()).$length(),$truthy((lhs=this.width,rhs=w,"number"==typeof lhs&&"number"==typeof rhs?lhs<rhs:lhs["$<"](rhs)))&&(this.width=w),this.list["$<<"]([label,blk]),this},$Job_item$11.$$arity=-1),Opal.alias(self,"report","item"),self.$attr_reader("list"),self.$attr_reader("width")}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){var $Report_initialize$12,$Report_item$13,self=$klass($base,null,"Report"),$nesting=[self].concat($parent_nesting);self.$$prototype.width=self.$$prototype.list=self.$$prototype.format=nil,Opal.def(self,"$initialize",$Report_initialize$12=function(width,format){var $a;return null==width&&(width=0),null==format&&(format=nil),$a=[width,format,[]],this.width=$a[0],this.format=$a[1],this.list=$a[2],$a},$Report_initialize$12.$$arity=-1),Opal.def(self,"$item",$Report_item$13=function($a,$b){var $post_args,label,format,res,$iter=$Report_item$13.$$p,blk=$iter||nil;return $iter&&($Report_item$13.$$p=null),$iter&&($Report_item$13.$$p=null),0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(label=$post_args[0],$post_args.splice(0,1)),null==label&&(label=""),format=$post_args,this.$print(label.$to_s().$ljust(this.width)),this.list["$<<"](res=$send($$($nesting,"Benchmark"),"measure",[label],blk.$to_proc())),this.$print($send(res,"format",[this.format].concat(Opal.to_a(format)))),res},$Report_item$13.$$arity=-1),Opal.alias(self,"report","item"),self.$attr_reader("list")}($nesting[0],0,$nesting),function($base,$super,$parent_nesting){var $Tms_initialize$14,$Tms_add$15,$Tms_add$excl$16,$Tms_$plus$17,$Tms_$minus$18,$Tms_$$19,$Tms_$slash$20,$Tms_format$21,$Tms_to_s$29,$Tms_to_a$30,$Tms_memberwise$31,self=$klass($base,null,"Tms"),$nesting=[self].concat($parent_nesting);self.$$prototype.utime=self.$$prototype.stime=self.$$prototype.cutime=self.$$prototype.cstime=self.$$prototype.label=self.$$prototype.real=nil,Opal.const_set($nesting[0],"CAPTION","      user     system      total        real\n"),Opal.const_set($nesting[0],"FORMAT","%10.6u %10.6y %10.6t %10.6r\n"),self.$attr_reader("utime"),self.$attr_reader("stime"),self.$attr_reader("cutime"),self.$attr_reader("cstime"),self.$attr_reader("real"),self.$attr_reader("total"),self.$attr_reader("label"),Opal.def(self,"$initialize",$Tms_initialize$14=function(utime,stime,cutime,cstime,real,label){var $a;return null==utime&&(utime=0),null==stime&&(stime=0),null==cutime&&(cutime=0),null==cstime&&(cstime=0),null==real&&(real=0),null==label&&(label=nil),$a=[utime,stime,cutime,cstime,real,label.$to_s()],this.utime=$a[0],this.stime=$a[1],this.cutime=$a[2],this.cstime=$a[3],this.real=$a[4],this.label=$a[5],this.total=$rb_plus($rb_plus($rb_plus(this.utime,this.stime),this.cutime),this.cstime)},$Tms_initialize$14.$$arity=-1),Opal.def(self,"$add",$Tms_add$15=function(){var $iter=$Tms_add$15.$$p,blk=$iter||nil;return $iter&&($Tms_add$15.$$p=null),$iter&&($Tms_add$15.$$p=null),$rb_plus(this,$send($$($nesting,"Benchmark"),"measure",[],blk.$to_proc()))},$Tms_add$15.$$arity=0),Opal.def(self,"$add!",$Tms_add$excl$16=function(){var $iter=$Tms_add$excl$16.$$p,blk=$iter||nil,t=nil;return $iter&&($Tms_add$excl$16.$$p=null),$iter&&($Tms_add$excl$16.$$p=null),t=$send($$($nesting,"Benchmark"),"measure",[],blk.$to_proc()),this.utime=$rb_plus(this.$utime(),t.$utime()),this.stime=$rb_plus(this.$stime(),t.$stime()),this.cutime=$rb_plus(this.$cutime(),t.$cutime()),this.cstime=$rb_plus(this.$cstime(),t.$cstime()),this.real=$rb_plus(this.$real(),t.$real()),this},$Tms_add$excl$16.$$arity=0),Opal.def(self,"$+",$Tms_$plus$17=function(other){return this.$memberwise("+",other)},$Tms_$plus$17.$$arity=1),Opal.def(self,"$-",$Tms_$minus$18=function(other){return this.$memberwise("-",other)},$Tms_$minus$18.$$arity=1),Opal.def(self,"$*",$Tms_$$19=function(x){return this.$memberwise("*",x)},$Tms_$$19.$$arity=1),Opal.def(self,"$/",$Tms_$slash$20=function(x){return this.$memberwise("/",x)},$Tms_$slash$20.$$arity=1),Opal.def(self,"$format",$Tms_format$21=function($a,$b){var $post_args,format,args,$c,$$22,$$23,$$24,$$25,$$26,$$27,$$28,str=nil;return 0<($post_args=Opal.slice.call(arguments,0,arguments.length)).length&&(format=$post_args[0],$post_args.splice(0,1)),null==format&&(format=nil),args=$post_args,str=$send($send($send($send($send($send($send(($truthy($c=format)?$c:$$($nesting,"FORMAT")).$dup(),"gsub",[/(%[-+.\d]*)n/],(($$22=function(){var $d,self=$$22.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"s")["$%"](self.$label())}).$$s=this,$$22.$$arity=0,$$22)),"gsub",[/(%[-+.\d]*)u/],(($$23=function(){var $d,self=$$23.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f")["$%"](self.$utime())}).$$s=this,$$23.$$arity=0,$$23)),"gsub",[/(%[-+.\d]*)y/],(($$24=function(){var $d,self=$$24.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f")["$%"](self.$stime())}).$$s=this,$$24.$$arity=0,$$24)),"gsub",[/(%[-+.\d]*)U/],(($$25=function(){var $d,self=$$25.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f")["$%"](self.$cutime())}).$$s=this,$$25.$$arity=0,$$25)),"gsub",[/(%[-+.\d]*)Y/],(($$26=function(){var $d,self=$$26.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f")["$%"](self.$cstime())}).$$s=this,$$26.$$arity=0,$$26)),"gsub",[/(%[-+.\d]*)t/],(($$27=function(){var $d,self=$$27.$$s||this;return((($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f")["$%"](self.$total())}).$$s=this,$$27.$$arity=0,$$27)),"gsub",[/(%[-+.\d]*)r/],(($$28=function(){var $d,self=$$28.$$s||this;return("("+(($d=$gvars["~"])===nil?nil:$d["$[]"](1))+"f)")["$%"](self.$real())}).$$s=this,$$28.$$arity=0,$$28)),$truthy(format)?str["$%"](args):str},$Tms_format$21.$$arity=-1),Opal.def(self,"$to_s",$Tms_to_s$29=function(){return this.$format()},$Tms_to_s$29.$$arity=0),Opal.def(self,"$to_a",$Tms_to_a$30=function(){return[this.label,this.utime,this.stime,this.cutime,this.cstime,this.real]},$Tms_to_a$30.$$arity=0),self.$protected(),Opal.def(self,"$memberwise",$Tms_memberwise$31=function(op,x){var self=this,$case=nil;return $case=x,$$$($$($nesting,"Benchmark"),"Tms")["$==="]($case)?$$$($$($nesting,"Benchmark"),"Tms").$new(self.$utime().$__send__(op,x.$utime()),self.$stime().$__send__(op,x.$stime()),self.$cutime().$__send__(op,x.$cutime()),self.$cstime().$__send__(op,x.$cstime()),self.$real().$__send__(op,x.$real())):$$$($$($nesting,"Benchmark"),"Tms").$new(self.$utime().$__send__(op,x),self.$stime().$__send__(op,x),self.$cutime().$__send__(op,x),self.$cstime().$__send__(op,x),self.$real().$__send__(op,x))},$Tms_memberwise$31.$$arity=2)}($nesting[0],0,$nesting),Opal.const_set($nesting[0],"CAPTION",$$$($$$($$($nesting,"Benchmark"),"Tms"),"CAPTION")),Opal.const_set($nesting[0],"FORMAT",$$$($$$($$($nesting,"Benchmark"),"Tms"),"FORMAT"))}($nesting[0],$nesting)};
