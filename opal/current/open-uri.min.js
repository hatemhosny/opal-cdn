Opal.modules.stringio=function(Opal){function $rb_gt(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?rhs<lhs:lhs["$>"](rhs)}function $rb_plus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs)}function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}Opal.top;var $nesting=[],nil=Opal.nil,$$$=Opal.$$$,$$=Opal.$$,$klass=Opal.klass,$truthy=Opal.truthy,$gvars=Opal.gvars;return Opal.add_stubs(["$include","$new","$call","$close","$attr_accessor","$length","$include?","$!","$check_readable","$==","$===","$>=","$raise","$>","$+","$-","$seek","$enum_for","$eof?","$ord","$[]","$to_str","$chomp","$check_writable","$String","$write","$closed_write?","$closed_read?"]),function($base,$StringIO_check_readable$19,$StringIO_check_writable$18){var $StringIO_open$1,$StringIO_each_byte$7,$StringIO_each_char$8,$StringIO_each$9,$StringIO_check_readable$19=$klass($base,$StringIO_check_readable$19,"StringIO"),$nesting=[$StringIO_check_readable$19].concat($StringIO_check_writable$18);return $StringIO_check_readable$19.$$prototype.position=$StringIO_check_readable$19.$$prototype.string=$StringIO_check_readable$19.$$prototype.closed=nil,$StringIO_check_readable$19.$include($$$($$($nesting,"IO"),"Readable")),$StringIO_check_readable$19.$include($$$($$($nesting,"IO"),"Writable")),Opal.defs($StringIO_check_readable$19,"$open",$StringIO_open$1=function(string,mode){var res,$iter=$StringIO_open$1.$$p,block=$iter||nil,io=nil;return $iter&&($StringIO_open$1.$$p=null),$iter&&($StringIO_open$1.$$p=null),null==string&&(string=""),null==mode&&(mode=nil),io=this.$new(string,mode),res=block.$call(io),io.$close(),res},$StringIO_open$1.$$arity=-1),$StringIO_check_readable$19.$attr_accessor("string"),Opal.def($StringIO_check_readable$19,"$initialize",$StringIO_check_writable$18=function(string,mode){var $ret_or_1=nil,$ret_or_2=nil;return null==string&&(string=""),null==mode&&(mode="rw"),this.string=string,this.position=string.$length(),$truthy($truthy($ret_or_1=mode["$include?"]("r"))?mode["$include?"]("w")["$!"]():$ret_or_1)?this.closed="write":$truthy($truthy($ret_or_2=mode["$include?"]("w"))?mode["$include?"]("r")["$!"]():$ret_or_2)?this.closed="read":nil},$StringIO_check_writable$18.$$arity=-1),Opal.def($StringIO_check_readable$19,"$eof?",$StringIO_check_writable$18=function(){return this.$check_readable(),this.position["$=="](this.string.$length())},$StringIO_check_writable$18.$$arity=0),Opal.alias($StringIO_check_readable$19,"eof","eof?"),Opal.def($StringIO_check_readable$19,"$seek",$StringIO_check_writable$18=function(pos,lhs){var $case,rhs;return null==lhs&&(lhs=$$$($$($nesting,"IO"),"SEEK_SET")),$case=lhs,$$$($$($nesting,"IO"),"SEEK_SET")["$==="]($case)?($truthy((rhs=0,"number"==typeof(lhs=pos)&&"number"==typeof rhs?rhs<=lhs:lhs["$>="](rhs)))||this.$raise($$$($$($nesting,"Errno"),"EINVAL")),this.position=pos):$$$($$($nesting,"IO"),"SEEK_CUR")["$==="]($case)?$truthy($rb_gt($rb_plus(this.position,pos),this.string.$length()))?this.position=this.string.$length():this.position=$rb_plus(this.position,pos):$$$($$($nesting,"IO"),"SEEK_END")["$==="]($case)&&($truthy($rb_gt(pos,this.string.$length()))?this.position=0:this.position=$rb_minus(this.position,pos)),0},$StringIO_check_writable$18.$$arity=-2),Opal.def($StringIO_check_readable$19,"$tell",$StringIO_check_writable$18=function(){return this.position},$StringIO_check_writable$18.$$arity=0),Opal.alias($StringIO_check_readable$19,"pos","tell"),Opal.alias($StringIO_check_readable$19,"pos=","seek"),Opal.def($StringIO_check_readable$19,"$rewind",$StringIO_check_writable$18=function(){return this.$seek(0)},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$each_byte",$StringIO_each_byte$7=function(){var $iter=$StringIO_each_byte$7.$$p,block=$iter||nil,i=nil;if($iter&&($StringIO_each_byte$7.$$p=null),$iter&&($StringIO_each_byte$7.$$p=null),!$truthy(block))return this.$enum_for("each_byte");for(this.$check_readable(),i=this.position;!$truthy(this["$eof?"]());)block.$call(this.string["$[]"](i).$ord()),i=$rb_plus(i,1);return this},$StringIO_each_byte$7.$$arity=0),Opal.def($StringIO_check_readable$19,"$each_char",$StringIO_each_char$8=function(){var $iter=$StringIO_each_char$8.$$p,block=$iter||nil,i=nil;if($iter&&($StringIO_each_char$8.$$p=null),$iter&&($StringIO_each_char$8.$$p=null),!$truthy(block))return this.$enum_for("each_char");for(this.$check_readable(),i=this.position;!$truthy(this["$eof?"]());)block.$call(this.string["$[]"](i)),i=$rb_plus(i,1);return this},$StringIO_each_char$8.$$arity=0),Opal.def($StringIO_check_readable$19,"$each",$StringIO_each$9=function(separator){var chomped=$StringIO_each$9.$$p,$yield=chomped||nil,chomp_lines=nil;if(null==$gvars["/"]&&($gvars["/"]=nil),chomped&&($StringIO_each$9.$$p=null),null==separator&&(separator=$gvars["/"]),$yield===nil)return this.$enum_for("each_line");this.$check_readable(),chomp_lines=!1,separator=$truthy($$$("::","Hash")["$==="](separator))?$truthy(chomp_lines=separator["$[]"]("chomp"))?/\r?\n/:$gvars["/"]:$truthy(separator)?separator.$to_str():void 0;var str=this.string,stringLength=str.length;if(this.position<stringLength&&(str=str.substr(this.position)),separator)for(var chomped=str.$chomp(),trailing=str.length!==chomped.length,splitted=chomped.split(separator),i=0,len=splitted.length;i<len;i++){var line=!chomp_lines&&(i<len-1||trailing)?splitted[i]+separator:splitted[i];Opal.yield1($yield,line)}else if(void 0===separator)Opal.yield1($yield,str);else for(var m,re=/(.+(?:\n\n|$))\n*/g;m=re.exec(str);)Opal.yield1($yield,m[1]);return this.position=stringLength,this},$StringIO_each$9.$$arity=-1),Opal.alias($StringIO_check_readable$19,"each_line","each"),Opal.def($StringIO_check_readable$19,"$write",$StringIO_check_writable$18=function(string){var before,after;return this.$check_writable(),string=this.$String(string),this.string.$length()["$=="](this.position)?this.string=$rb_plus(this.string,string):(before=this.string["$[]"](Opal.Range.$new(0,$rb_minus(this.position,1),!1)),after=this.string["$[]"](Opal.Range.$new($rb_plus(this.position,string.$length()),-1,!1)),this.string=$rb_plus($rb_plus(before,string),after)),this.position=$rb_plus(this.position,string.$length())},$StringIO_check_writable$18.$$arity=1),Opal.def($StringIO_check_readable$19,"$read",$StringIO_check_writable$18=function(length,outbuf){var self=this,string=nil,str=nil;return null==length&&(length=nil),null==outbuf&&(outbuf=nil),self.$check_readable(),$truthy(self["$eof?"]())?nil:($truthy(length)?(str=self.string["$[]"](self.position,length),self.position=$rb_plus(self.position,length)):(str=self.string["$[]"](Opal.Range.$new(self.position,-1,!1)),self.position=self.string.$length()),string=str,$truthy(outbuf)?outbuf.$write(string):string)},$StringIO_check_writable$18.$$arity=-1),Opal.def($StringIO_check_readable$19,"$close",$StringIO_check_writable$18=function(){return this.closed="both"},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$close_read",$StringIO_check_writable$18=function(){return this.closed["$=="]("write")?this.closed="both":this.closed="read"},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$close_write",$StringIO_check_writable$18=function(){return this.closed["$=="]("read")?this.closed="both":this.closed="write"},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$closed?",$StringIO_check_writable$18=function(){return this.closed["$=="]("both")},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$closed_read?",$StringIO_check_writable$18=function(){var $ret_or_3;return $truthy($ret_or_3=this.closed["$=="]("read"))?$ret_or_3:this.closed["$=="]("both")},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$closed_write?",$StringIO_check_writable$18=function(){var $ret_or_4;return $truthy($ret_or_4=this.closed["$=="]("write"))?$ret_or_4:this.closed["$=="]("both")},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$check_writable",$StringIO_check_writable$18=function(){return $truthy(this["$closed_write?"]())?this.$raise($$($nesting,"IOError"),"not opened for writing"):nil},$StringIO_check_writable$18.$$arity=0),Opal.def($StringIO_check_readable$19,"$check_readable",$StringIO_check_readable$19=function(){return $truthy(this["$closed_read?"]())?this.$raise($$($nesting,"IOError"),"not opened for reading"):nil},$StringIO_check_readable$19.$$arity=0),nil&&"check_readable"}($nesting[0],$$($nesting,"IO"),$nesting)},Opal.modules["corelib/pack_unpack/format_string_parser"]=function(Opal){Opal.top;var $nesting=[],$$=(Opal.nil,Opal.$$$,Opal.$$),$module=Opal.module;return Opal.add_stubs(["$raise"]),function($base,$parent_nesting){var self=$module($base,"PackUnpack"),$nesting=[self].concat($parent_nesting),directives=["C","S","L","Q","J","c","s","l","q","j","n","N","v","V","U","w","D","d","F","f","E","e","G","g","A","a","Z","B","b","H","h","u","M","m","P","p","@","X","x"],modifiers=["!","_",">","<"];self.eachDirectiveAndCount=function(format,callback){var currentDirective,currentCount,currentModifiers,countSpecified;function reset(){currentDirective=null,currentCount=0,countSpecified=!(currentModifiers=[])}function yieldAndReset(){null!=currentDirective&&(!/[sSiIlLqQjJ]/.test(currentDirective)&&0<currentModifiers.length&&self.$raise($$($nesting,"ArgumentError"),"'"+currentModifiers[0]+"' allowed only after types sSiIlLqQjJ"),-1!==currentModifiers.indexOf("<")&&-1!==currentModifiers.indexOf(">")&&self.$raise($$($nesting,"RangeError"),"Can't use both '<' and '>'"),countSpecified||(currentCount=1),-1!==currentModifiers.indexOf(">")&&(currentDirective+=">"),callback(currentDirective,currentCount)),reset()}reset();for(var i=0;i<format.length;i++){var currentChar=format[i];-1!==directives.indexOf(currentChar)?(yieldAndReset(),currentDirective=currentChar):currentDirective&&(/\d/.test(currentChar)?(currentCount=10*currentCount+parseInt(currentChar,10),countSpecified=!0):"*"===currentChar&&!1===countSpecified?(currentCount=1/0,countSpecified=!0):-1!==modifiers.indexOf(currentChar)&&!1===countSpecified?currentModifiers.push(currentChar):yieldAndReset())}yieldAndReset()}}($nesting[0],$nesting)},Opal.modules["corelib/array/pack"]=function(Opal){var self=Opal.top,$nesting=[],nil=Opal.nil,$$=(Opal.$$$,Opal.$$),$coerce_to=Opal.coerce_to,$klass=Opal.klass;return Opal.add_stubs(["$require","$raise","$delete","$gsub","$coerce_to!","$inspect"]),self.$require("corelib/pack_unpack/format_string_parser"),function($base,$Array_pack$1){var self=$klass($base,null,"Array"),$nesting=[self].concat($Array_pack$1),eachDirectiveAndCount=Opal.PackUnpack.eachDirectiveAndCount;function identityFunction(value){return value}function asciiBytesToUtf16LEString(bytes){return String.fromCharCode.apply(null,bytes)}function asciiStringFromUnsignedInt(bytes,callback){return function(data){return callback(data).map(function(item){for(var result=[],i=0;i<bytes;i++){var bit=255&item;result.push(bit),item>>=8}return asciiBytesToUtf16LEString(result)})}}function asciiStringFromSignedInt(bytes,callback){return function(bits){var buffer=callback(bits),bits=8*bytes,limit=Math.pow(2,bits);return buffer.map(function(item){item<0&&(item+=limit);for(var result=[],i=0;i<bytes;i++){var bit=255&item;result.push(bit),item>>=8}return asciiBytesToUtf16LEString(result)})}}function toInt(callback){return function(data){return callback(data).map(function(item){return $coerce_to(item,$$($nesting,"Integer"),"to_int")})}}function joinChars(callback){return function(data){return callback(data).join("")}}var callback,handlers={C:joinChars(asciiStringFromUnsignedInt(1,toInt(identityFunction))),S:joinChars(asciiStringFromUnsignedInt(2,toInt(identityFunction))),L:joinChars(asciiStringFromUnsignedInt(4,toInt(identityFunction))),Q:joinChars(asciiStringFromUnsignedInt(8,toInt(identityFunction))),J:null,"S>":null,"L>":null,"Q>":null,c:joinChars(asciiStringFromSignedInt(1,toInt(identityFunction))),s:joinChars(asciiStringFromSignedInt(2,toInt(identityFunction))),l:joinChars(asciiStringFromSignedInt(4,toInt(identityFunction))),q:joinChars(asciiStringFromSignedInt(8,toInt(identityFunction))),j:null,"s>":null,"l>":null,"q>":null,n:null,N:null,v:null,V:null,U:joinChars((callback=toInt(identityFunction),function(data){return callback(data).map(function(item){try{return String.fromCodePoint(item)}catch(error){throw error instanceof RangeError&&self.$raise($$($nesting,"RangeError"),"value out of range"),error}})})),w:null,D:null,d:null,F:null,f:null,E:null,e:null,G:null,g:null,A:joinChars(identityFunction),a:joinChars(identityFunction),Z:null,B:null,b:null,H:null,h:null,u:null,M:null,m:null,P:null,p:null};function readNTimesFromBufferAndMerge(callback){return function(buffer,count){var chunkData,chunk=[];if(count===1/0)for(;0<buffer.length;)buffer=(chunkData=callback(buffer)).rest,chunk=chunk.concat(chunkData.chunk);else{buffer.length<count&&self.$raise($$($nesting,"ArgumentError"),"too few arguments");for(var i=0;i<count;i++)buffer=(chunkData=callback(buffer)).rest,chunk=chunk.concat(chunkData.chunk)}return{chunk:chunk,rest:buffer}}}function readItem(buffer){return{chunk:buffer.slice(0,1),rest:buffer=buffer.slice(1,buffer.length)}}function readNCharsFromTheFirstItemAndMergeWithFallback(fallback,callback){return function(buffer,count){var subChunk,chunk=[],source=buffer[0];if(source===nil?source="":void 0===source?self.$raise($$($nesting,"ArgumentError"),"too few arguments"):source=$coerce_to(source,$$($nesting,"String"),"to_str"),buffer=buffer.slice(1,buffer.length),count===1/0)for(;0<source.length;)subChunk=void 0,subChunk=callback(source),source=subChunk.rest,1===(subChunk=subChunk.chunk).length&&subChunk[0]===nil&&(subChunk=[]),chunk=chunk.concat(subChunk);else for(var i=0;i<count;i++)!function(){var subChunk=callback(source);source=subChunk.rest,0===(subChunk=subChunk.chunk).length&&(subChunk=[fallback]),1===subChunk.length&&subChunk[0]===nil&&(subChunk=[fallback]),chunk=chunk.concat(subChunk)}();return{chunk:chunk,rest:buffer}}}var readChunk={C:readNTimesFromBufferAndMerge(readItem),S:readNTimesFromBufferAndMerge(readItem),L:readNTimesFromBufferAndMerge(readItem),Q:readNTimesFromBufferAndMerge(readItem),J:null,"S>":null,"L>":null,"Q>":null,c:readNTimesFromBufferAndMerge(readItem),s:readNTimesFromBufferAndMerge(readItem),l:readNTimesFromBufferAndMerge(readItem),q:readNTimesFromBufferAndMerge(readItem),j:null,"s>":null,"l>":null,"q>":null,n:null,N:null,v:null,V:null,U:readNTimesFromBufferAndMerge(readItem),w:null,D:null,d:null,F:null,f:null,E:null,e:null,G:null,g:null,A:readNCharsFromTheFirstItemAndMergeWithFallback(" ",readItem),a:readNCharsFromTheFirstItemAndMergeWithFallback("\0",readItem),Z:null,B:null,b:null,H:null,h:null,u:null,M:null,m:null,P:null,p:null},autocompletion={C:!1,S:!1,L:!1,Q:!1,J:null,"S>":null,"L>":null,"Q>":null,c:!1,s:!1,l:!1,q:!1,j:null,"s>":null,"l>":null,"q>":null,n:null,N:null,v:null,V:null,U:!1,w:null,D:null,d:null,F:null,f:null,E:null,e:null,G:null,g:null,A:!1,a:!1,Z:null,B:null,b:null,H:null,h:null,u:!1,M:null,m:null,P:null,p:null};return Opal.def(self,"$pack",$Array_pack$1=function(format){var self=this;format=$$($nesting,"Opal")["$coerce_to!"](format,$$($nesting,"String"),"to_str").$gsub(/\s/,"").$delete("\0");var output="",buffer=self.slice();return eachDirectiveAndCount(format,function(directive,count){var shouldAutocomplete,part=function(directive,chunk){var handler=readChunk[directive];return null==handler&&self.$raise("Unsupported pack directive "+directive.$inspect()+" (no chunk reader defined)"),handler=handler(buffer,chunk),chunk=handler.chunk,buffer=handler.rest,null==(handler=handlers[directive])&&self.$raise("Unsupported pack directive "+directive.$inspect()+" (no handler defined)"),handler(chunk)}(directive,count);count!==1/0&&(null==(shouldAutocomplete=autocompletion[directive])&&self.$raise("Unsupported pack directive "+directive.$inspect()+" (no autocompletion rule defined)"),shouldAutocomplete&&function(array,size){for(;array.length<size;)array.push(nil)}(part,count)),output=output.concat(part)}),output},$Array_pack$1.$$arity=1),nil&&"pack"}($nesting[0],$nesting)},Opal.modules["open-uri"]=function(Opal){function $rb_minus(lhs,rhs){return"number"==typeof lhs&&"number"==typeof rhs?lhs-rhs:lhs["$-"](rhs)}var self=Opal.top,$nesting=[],nil=Opal.nil,$$$=Opal.$$$,$$=Opal.$$,$module=Opal.module,$truthy=Opal.truthy,$send=Opal.send,$hash2=Opal.hash2,$klass=Opal.klass,$send2=Opal.send2;return Opal.add_stubs(["$require","$private","$respond_to?","$=~","$open_uri","$to_proc","$open_uri_original_open","$module_function","$open_loop","$rewind","$close_io","$close!","$closed?","$close","$request","$==","$build_response","$raise","$new","$<<","$pack","$data","$io","$status=","$-","$meta_add_field","$attr_reader","$+","$length","$===","$init","$extend","$instance_eval","$status","$base_uri","$base_uri=","$each","$metas","$meta_add_field2","$attr_accessor","$charset","$find_encoding","$set_encoding","$force_encoding","$string","$find","$downcase","$[]=","$join","$meta_setup_encoding","$[]","$utc","$at","$content_type_parse","$scheme","$open","$read"]),self.$require("stringio"),self.$require("corelib/array/pack"),function(self,$parent_nesting){var $Kernel_open$1,$nesting=[self=$module(self,"Kernel")].concat($parent_nesting);self.$private(),Opal.alias(self,"open_uri_original_open","open"),function(self,$parent_nesting){[self].concat($parent_nesting),Opal.alias(self,"open_uri_original_open","open")}(Opal.get_singleton_class(self),$nesting),Opal.def(self,"$open",$Kernel_open$1=function(name,$a){var rest=$Kernel_open$1.$$p,block=rest||nil,$ret_or_1=nil;return rest&&($Kernel_open$1.$$p=null),rest&&($Kernel_open$1.$$p=null),rest=Opal.slice.call(arguments,1,arguments.length),$truthy($truthy($ret_or_1=name["$respond_to?"]("to_str"))?/^[A-Za-z][A-Za-z0-9+\-\.]*:\/\//["$=~"](name):$ret_or_1)?$send($$($nesting,"OpenURI"),"open_uri",[name].concat(Opal.to_a(rest)),block.$to_proc()):$send(this,"open_uri_original_open",[name].concat(Opal.to_a(rest)),block.$to_proc())},$Kernel_open$1.$$arity=-2),self.$module_function("open")}($nesting[0],$nesting),function($OpenURI_request$7,$OpenURI_data$6){var $OpenURI_open_uri$2,$OpenURI_request$7=$module($OpenURI_request$7,"OpenURI"),$nesting=[$OpenURI_request$7].concat($OpenURI_data$6);Opal.defs($OpenURI_request$7,"$open_uri",$OpenURI_open_uri$2=function(name,$a){var $iter=$OpenURI_open_uri$2.$$p,$yield=$iter||nil,self=this,io=nil;return $iter&&($OpenURI_open_uri$2.$$p=null),Opal.slice.call(arguments,1,arguments.length),(io=self.$open_loop(name,$hash2([],{}))).$rewind(),$yield!==nil?function(){try{return Opal.yield1($yield,io)}finally{self.$close_io(io)}}():io},$OpenURI_open_uri$2.$$arity=-2),Opal.defs($OpenURI_request$7,"$close_io",$OpenURI_data$6=function(io){return $truthy(io["$respond_to?"]("close!"))?io["$close!"]():$truthy(io["$closed?"]())?nil:io.$close()},$OpenURI_data$6.$$arity=1),Opal.defs($OpenURI_request$7,"$open_loop",$OpenURI_data$6=function(uri){var req=nil,status=nil,$ret_or_2=nil,$ret_or_3=nil,data=(req=this.$request(uri)).responseText,status=req.status,status_text=req.statusText&&req.statusText.errno?req.statusText.errno:req.statusText;return $truthy($truthy($ret_or_2=status["$=="](200))?$ret_or_2:$truthy($ret_or_3=status["$=="](0))?data:$ret_or_3)?this.$build_response(req,status,status_text):this.$raise($$$($$($nesting,"OpenURI"),"HTTPError").$new(status+" "+status_text,""))},$OpenURI_data$6.$$arity=2),Opal.defs($OpenURI_request$7,"$build_response",$OpenURI_data$6=function(req,status,status_text){var $writer,last_modified,buf=nil,io=nil;return(buf=$$($nesting,"Buffer").$new())["$<<"](this.$data(req).$pack("c*")),io=buf.$io(),$writer=[status+" "+status_text],$send(io,"status=",Opal.to_a($writer)),$rb_minus($writer.length,1),io.$meta_add_field("content-type",req.getResponseHeader("Content-Type")||""),last_modified=req.getResponseHeader("Last-Modified"),$truthy(last_modified)&&io.$meta_add_field("last-modified",last_modified),io},$OpenURI_data$6.$$arity=3),Opal.defs($OpenURI_request$7,"$data",$OpenURI_data$6=function(req){for(var binStr=req.responseText,byteArray=[],i=0,len=binStr.length;i<len;++i){var byteCode=255&binStr.charCodeAt(i);byteArray.push(byteCode)}return byteArray},$OpenURI_data$6.$$arity=1),Opal.defs($OpenURI_request$7,"$request",$OpenURI_request$7=function(uri){try{var xhr=new XMLHttpRequest;return xhr.open("GET",uri,!1),xhr.overrideMimeType("text/plain; charset=x-user-defined"),xhr.send(),xhr}catch(error){this.$raise($$$($$($nesting,"OpenURI"),"HTTPError").$new(error.message,""))}},$OpenURI_request$7.$$arity=1),function($base,self,$parent_nesting){var $HTTPError_initialize$8;[self=$klass($base,self,"HTTPError")].concat($parent_nesting),Opal.def(self,"$initialize",$HTTPError_initialize$8=function(message,io){var $iter=$HTTPError_initialize$8.$$p;return $iter&&($HTTPError_initialize$8.$$p=null),$send2(this,Opal.find_super_dispatcher(this,"initialize",$HTTPError_initialize$8,!1,!0),"initialize",[message,io],null),this.io=io},$HTTPError_initialize$8.$$arity=2),self.$attr_reader("io")}($nesting[0],$$($nesting,"StandardError"),$nesting),function($Buffer_io$11,$Buffer_$lt$lt$10){var $nesting=[$Buffer_io$11=$klass($Buffer_io$11,null,"Buffer")].concat($Buffer_$lt$lt$10);$Buffer_io$11.$$prototype.io=$Buffer_io$11.$$prototype.size=nil,Opal.def($Buffer_io$11,"$initialize",$Buffer_$lt$lt$10=function(){return this.io=$$($nesting,"StringIO").$new(),this.size=0},$Buffer_$lt$lt$10.$$arity=0),$Buffer_io$11.$attr_reader("size"),Opal.def($Buffer_io$11,"$<<",$Buffer_$lt$lt$10=function(rhs){var lhs;return this.io["$<<"](rhs),this.size=(lhs=this.size,rhs=rhs.$length(),"number"==typeof lhs&&"number"==typeof rhs?lhs+rhs:lhs["$+"](rhs))},$Buffer_$lt$lt$10.$$arity=1),Opal.def($Buffer_io$11,"$io",$Buffer_io$11=function(){return $truthy($$($nesting,"Meta")["$==="](this.io))||$$($nesting,"Meta").$init(this.io),this.io},$Buffer_io$11.$$arity=0)}($nesting[0],$nesting),function($Meta_content_type$23,$Meta_charset$22){var $nesting=[$Meta_content_type$23=$module($Meta_content_type$23,"Meta")].concat($Meta_charset$22);Opal.defs($$($nesting,"Meta"),"$init",$Meta_charset$22=function(obj,src){var $$13,$$14,$writer;return null==src&&(src=nil),obj.$extend($$($nesting,"Meta")),$send(obj,"instance_eval",[],(($$13=function(){var self=null==$$13.$$s?this:$$13.$$s;return self.base_uri=nil,self.meta=$hash2([],{}),self.metas=$hash2([],{})}).$$s=this,$$13.$$arity=0,$$13)),$truthy(src)?($writer=[src.$status()],$send(obj,"status=",Opal.to_a($writer)),$rb_minus($writer.length,1),$writer=[src.$base_uri()],$send(obj,"base_uri=",Opal.to_a($writer)),$rb_minus($writer.length,1),$send(src.$metas(),"each",[],(($$14=function(name,values){null==$$14.$$s||$$14.$$s;return null==name&&(name=nil),null==values&&(values=nil),obj.$meta_add_field2(name,values)}).$$s=this,$$14.$$arity=2,$$14))):nil},$Meta_charset$22.$$arity=-2),$Meta_content_type$23.$attr_accessor("status"),$Meta_content_type$23.$attr_accessor("base_uri"),$Meta_content_type$23.$attr_reader("meta"),$Meta_content_type$23.$attr_reader("metas"),Opal.def($Meta_content_type$23,"$meta_setup_encoding",$Meta_charset$22=function(){var charset=this.$charset(),enc=this.$find_encoding(charset);return this.$set_encoding(enc)},$Meta_charset$22.$$arity=0),Opal.def($Meta_content_type$23,"$set_encoding",$Meta_charset$22=function(enc){return $truthy(this["$respond_to?"]("force_encoding"))?this.$force_encoding(enc):$truthy(this["$respond_to?"]("string"))?this.$string().$force_encoding(enc):this.$set_encoding(enc)},$Meta_charset$22.$$arity=1),Opal.def($Meta_content_type$23,"$find_encoding",$Meta_charset$22=function(charset){var enc=nil,enc=nil;if($truthy(charset))try{enc=$$($nesting,"Encoding").$find(charset)}catch($err){if(!Opal.rescue($err,[$$($nesting,"ArgumentError")]))throw $err;Opal.pop_exception()}return $truthy(enc)||(enc=$$$($$($nesting,"Encoding"),"ASCII_8BIT")),enc},$Meta_charset$22.$$arity=1),Opal.def($Meta_content_type$23,"$meta_add_field2",$Meta_charset$22=function(name,values){var $writer;return null==this.metas&&(this.metas=nil),null==this.meta&&(this.meta=nil),$writer=[name=name.$downcase(),values],$send(this.metas,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),$writer=[name,values.$join(", ")],$send(this.meta,"[]=",Opal.to_a($writer)),$rb_minus($writer.length,1),name["$=="]("content-type")?this.$meta_setup_encoding():nil},$Meta_charset$22.$$arity=2),Opal.def($Meta_content_type$23,"$meta_add_field",$Meta_charset$22=function(name,value){return this.$meta_add_field2(name,[value])},$Meta_charset$22.$$arity=2),Opal.def($Meta_content_type$23,"$last_modified",$Meta_charset$22=function(){var vs=nil;return null==this.metas&&(this.metas=nil),$truthy(vs=this.metas["$[]"]("last-modified"))?$$($nesting,"Time").$at(Date.parse(vs.$join(", "))/1e3).$utc():nil},$Meta_charset$22.$$arity=0),Opal.def($Meta_content_type$23,"$content_type_parse",$Meta_charset$22=function(){return null==this.metas&&(this.metas=nil),this.metas["$[]"]("content-type").$join(", ")},$Meta_charset$22.$$arity=0),Opal.def($Meta_content_type$23,"$charset",$Meta_charset$22=function(){var type,self=this,$ret_or_4=nil,$ret_or_5=nil,$ret_or_6=nil;return null==self.base_uri&&(self.base_uri=nil),type=self.$content_type_parse(),$truthy($truthy($ret_or_4=$truthy($ret_or_5=$truthy($ret_or_6=type)?/^text\//["$=~"](type):$ret_or_6)?self.base_uri:$ret_or_5)?/^http$/i["$=~"](self.base_uri.$scheme()):$ret_or_4)?"iso-8859-1":nil},$Meta_charset$22.$$arity=0),Opal.def($Meta_content_type$23,"$content_type",$Meta_content_type$23=function(){var $ret_or_7,type=this.$content_type_parse();return $truthy($ret_or_7=type)?$ret_or_7:"application/octet-stream"},$Meta_content_type$23.$$arity=0)}($nesting[0],$nesting),function($OpenRead_read$25,$parent_nesting){var $OpenRead_open$24,$nesting=[$OpenRead_read$25=$module($OpenRead_read$25,"OpenRead")].concat($parent_nesting);Opal.def($OpenRead_read$25,"$open",$OpenRead_open$24=function($a){var rest=$OpenRead_open$24.$$p,block=rest||nil,self=this;return rest&&($OpenRead_open$24.$$p=null),rest&&($OpenRead_open$24.$$p=null),rest=Opal.slice.call(arguments,0,arguments.length),$send($$($nesting,"OpenURI"),"open_uri",[self].concat(Opal.to_a(rest)),block.$to_proc())},$OpenRead_open$24.$$arity=-1),Opal.def($OpenRead_read$25,"$read",$OpenRead_read$25=function(options){var $$26;return null==options&&(options=$hash2([],{})),$send(this,"open",[options],(($$26=function(f){var str;null==$$26.$$s||$$26.$$s;return null==f&&(f=nil),str=f.$read(),$$($nesting,"Meta").$init(str,f),str}).$$s=this,$$26.$$arity=1,$$26))},$OpenRead_read$25.$$arity=-1)}($nesting[0],$nesting)}($nesting[0],$nesting)};
